{% extends "base.html" %}
{% block title %}Home | Pathdarshak AI{% endblock %}

{% block content %}
<style>
  /* ‚ú® Twinkling card border */
  .astro-card {
    position: relative;
    overflow: hidden;
    border-radius: 12px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .astro-card:hover {
    transform: translateY(-6px) scale(1.02);
    box-shadow: 0 0 25px rgba(255, 215, 0, 0.6);
  }

  .astro-card::before {
    content: "";
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: conic-gradient(
      from 0deg,
      #ffd700,
      #ff69b4,
      #00ffff,
      #ffd700
    );
    animation: spin 6s linear infinite;
    z-index: 0;
  }

  .astro-card::after {
    content: "";
    position: absolute;
    inset: 2px;
    background: rgba(0, 0, 0, 0.9);
    border-radius: 10px;
    z-index: 1;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* Inner content sits above glow */
  .astro-card .card-body {
    position: relative;
    z-index: 2;
  }

  /* ‚ú® Shimmer text effect */
  .shimmer {
    background: linear-gradient(90deg, #fff, #fffa, #fff);
    background-size: 200% 100%;
    animation: shimmer 3s infinite;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  @keyframes shimmer {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
  }
</style>

<!-- Hero Section -->
<div class="text-center mb-5">
  <h1 class="display-4 fw-bold text-warning">‚ú®<span class="shimmer">Welcome To Pathdarshak AI</span> ‚ú®</h1>
  <p class="lead text-light">
    Your AI-powered guide for <span class="fw-semibold text-info">Daily Horoscopes, Kundli Insights, And Compatibility Checks</span>.
  </p>
</div>

<!-- Feature Cards -->
<div class="row g-4 justify-content-center">
  {% if user.is_authenticated %}
    <div class="col-md-4 col-sm-6">
      <div class="card astro-card shadow-lg h-100 text-center">
        <div class="card-body text-white">
          <h5 class="card-title fw-bold">üåû<span class="shimmer"> Daily Horoscope</span></h5>
          <p class="card-text">Personalized predictions for your day, based on your stars.</p>
          <a href="{% url 'horoscope' %}" class="btn btn-light btn-sm mt-2">Get Horoscope</a>
        </div>
      </div>
    </div>

    <div class="col-md-4 col-sm-6">
      <div class="card astro-card shadow-lg h-100 text-center">
        <div class="card-body text-white">
          <h5 class="card-title fw-bold">üïâ<span class="shimmer"> Daily Panchang</span></h5>
          <p class="card-text">Your daily Panchang guide for the perfect blend of tradition, timing, and cosmic energy.</p>
          {% comment %} <a href="{% url 'panchang' %}" class="btn btn-light btn-sm mt-2">Get panchang</a> {% endcomment %}
          <form action="{% url 'panchang' %}" method="post" id="panchangForm"></form>
          <input type="hidden" name="place" id="place"/>
            <a href="#" onclick="document.getElementById('panchangForm').submit()" class="btn btn-light btn-sm mt-2">
              Get Panchnag
            </a>
          </form>
        </div>
      </div>
    </div>

    <div class="col-md-4 col-sm-6">
      <div class="card astro-card shadow-lg h-100 text-center">
        <div class="card-body text-white">
          <h5 class="card-title fw-bold">üìú<span class="shimmer">Kundli</span></h5>
          <p class="card-text">Discover your birth chart and its hidden messages.</p>
          {% comment %} <a href="{% url 'kundali' %}" class="btn btn-light btn-sm mt-2">Get Kundali</a> {% endcomment %}
          <form action="{% url 'kundali' %}" method="post">
          {% csrf_token %}
          <input type="number" name="year" value= "{{ year }}" hidden/>
          <input type="number" name="month" value= "{{ month }}" hidden/>
          <input type="number" name="day" value= "{{ day }}" hidden/>
          <input type="number" name="hour" value= "{{ hour }}" hidden/>
          <input type="number" name="minute" value= "{{ minute }}" hidden/>
          <input type="number" name="second" value= "{{ second }}" hidden/>
          <input type="text" name="place" value= "{{ birth_place }}" hidden/>
            <button type="submit" class="btn btn-light btn-sm mt-2">
              Get Kundali
            </button>
          </form>
        </div>
      </div>
    </div>

    <div class="col-md-4 col-sm-6">
      <div class="card astro-card shadow-lg h-100 text-center">
        <div class="card-body text-white">
          <h5 class="card-title fw-bold">ü§ù<span class="shimmer"> Kundli Matching</span></h5>
          <p class="card-text">Check love compatibility and marriage prediction.</p>
          <a href="{% url 'kundali-match' %}" class="btn btn-light btn-sm mt-2">View Report</a>
        </div>
      </div>
    </div>
    
    <div class="col-md-4 col-sm-6">
      <div class="card astro-card shadow-lg h-100 text-center">
        <div class="card-body text-white">
          <h5 class="card-title fw-bold">üíû<span class="shimmer"> Compatibility</span></h5>
          <p class="card-text">See how your stars align with someone special.</p>
          <a href="{% url 'compatibility' %}" class="btn btn-light btn-sm mt-2">Check Now</a>
        </div>
      </div>
    </div>

    <div class="col-md-4 col-sm-6">
      <div class="card astro-card shadow-lg h-100 text-center">
        <div class="card-body text-white">
          <h5 class="card-title fw-bold">‚òØÔ∏é<span class="shimmer"> Chinese Zodiac</span></h5>
          <p class="card-text">Get your Chinese zodiac (Bazi) chart.</p>
          {% comment %} <a href="{% url 'bazi' %}" class="btn btn-light btn-sm mt-2">Check Now</a> {% endcomment %}
          <form action="{% url 'bazi' %}" method="post">
          {% csrf_token %}
          <input type="number" name="year" value= "{{ year }}" hidden/>
          <input type="number" name="month" value= "{{ month }}" hidden/>
          <input type="number" name="day" value= "{{ day }}" hidden/>
          <input type="number" name="hour" value= "{{ hour }}" hidden/>
            <button type="submit" class="btn btn-light btn-sm mt-2">
              Check Now
            </button>
          </form>
        </div>
      </div>
    </div>

    <div class="col-md-4 col-sm-6">
      <div class="card astro-card shadow-lg h-100 text-center">
        <div class="card-body text-white">
          <h5 class="card-title fw-bold">üîÆ<span class="shimmer"> Tarot Card</span></h5>
          <p class="card-text">Unlock your hidden potential with Tarot's revelations.</p>
          <a href="{% url 'tarot' %}" class="btn btn-light btn-sm mt-2">Check Now</a>
        </div>
      </div>
    </div>
  {% else %}
    <div class="col-12">
      <div class="alert alert-info text-center shadow-sm">
        Please <a href="{% url 'login' %}" class="alert-link">login</a> or 
        <a href="{% url 'signup' %}" class="alert-link">signup</a> to access your readings.
      </div>
    </div>
  {% endif %}
</div>
<script>
  const placeInput = document.getElementById('place')
  if (!navigator.geolocation) {
    alert("Geolocation not supported by your browser");
  }

  navigator.geolocation.getCurrentPosition(async function(position) {
    const lat = position.coords.latitude;
    const lon = position.coords.longitude;

    // Example using OpenStreetMap Nominatim API
    const res = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json`);
    const data = await res.json();
    
    // Full address
    const address = data.display_name;
    console.log("Full Address:", address);

    // Populate place input
    if(placeInput) placeInput.value = address;
  })
</script>
{% endblock %}
